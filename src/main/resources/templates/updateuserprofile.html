<!DOCTYPE html>
<html lang="en"
  xmlns:th="http://www.thymeleaf.org"
>
<head>
	<meta charset="UTF-8">
	<title>Update your profile</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
        rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
        crossorigin="anonymous">
</head>
<body>
	<div class="row col-md-8 offset-md2">
		<div class="card">
			<div class="card-header">
          <h2 class="text-center">Update Profile</h2>
      </div>
		<div th:if="${param.success}">
          <div class="alert alert-info">
            You have successfully updated profile!
          </div>
      </div>
	<div class="cord-body">
		<form
			method = "post"
			role ="form"
			th:action="@{/updateuserprofile/save}"
			th:object="${userProfile}"
			>
				<div class="form-group mb-3">
					<label class="form-label">User Name</label>
					<input 
					  class="form-control"
                      id="userName"
                      name="userName"
                      placeholder="Enter user name"
                      th:field="*{userName}"
                      type="text"
              		/>
				</div>
				<div class="form-group mb-3">
					<label class="form-label">First Name</label>
					<input 
					  class="form-control"
                      id="firstName"
                      name="firstName"
                      placeholder="Enter first name"
                      th:field="*{firstName}"
                      type="text"
              		/>
				</div>
				<div class="form-group mb-3">
					<label class="form-label">Last Name</label>
					<input 
					  class="form-control"
                      id="lastName"
                      name="lastName"
                      placeholder="Enter last name"
                      th:field="*{lastName}"
                      type="text"
              		/>
				</div>
				<div class="form-group mb-3">
					<label class="form-label">Email ID</label>
					<input 
					  class="form-control"
                      id="emailId"
                      name="emailId"
                      placeholder="Enter email id"
                      th:field="*{emailId}"
                      type="text"
              		/>
				</div>
				<!-- Input fields for updating favorite books -->
				<div class="form-group mb-3" th:each="bookName, iterStat : *{favoriteBookNames}">
   				 <label th:for="'favoriteBookNames[' + ${iterStat.index} + ']'" class="form-label">
       					 Favorite Book <span th:text="${iterStat.index + 1}"></span>
   				 </label>
    			<input 
    				class="form-control" 
    				th:id="'favoriteBookNames[' + ${iterStat.index} + ']'" 
          			th:name="'favoriteBookNames[' + ${iterStat.index} + ']'" 
                    th:field="*{favoriteBookNames[__${iterStat.index}__]}" 
           			type="text" 
           			th:value="${bookName}"/>
				</div>
                
                <!-- Add a new favorite book -->
                <div class="form-group mb-3">
                    <label for="newBook" class="form-label">Add Favorite Book</label>
                    <input 
                    	class="form-control" 
                    	id="favoriteBookNames" 
                    	name="favoriteBookNames" 
                    	placeholder="Enter new book name"/>
                </div>
                 <!-- Button to add a new favorite book -->
                <div class="form-group mb-3">
                    <button type="button" class="btn btn-secondary" onclick="addNewBook()">Add New Book</button>
                </div>
				
			<div class="form-group">
              <button class="btn btn-primary" type="submit">Update</button>
            </div>
			</form>
		<a href="/homepage">Back to Homepage</a>
	</div>
	</div>
	</div>
	
	
 <script th:inline="javascript">
        function addNewBook() {
            var container = document.getElementById('newBooksContainer');
            var index = container.children.length;

            var label = document.createElement('label');
            label.innerHTML = 'New Favorite Book ' + (index + 1);

            var input = document.createElement('input');
            input.type = 'text';
            input.classList.add('form-control');
            input.name = 'newFavoriteBooks[' + index + ']';

            container.appendChild(label);
            container.appendChild(input);
        }
    </script>

</body>